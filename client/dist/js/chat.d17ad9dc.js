(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chat"],{"293a":function(t,e,c){"use strict";c.r(e);var o=c("7a23"),n={key:0,class:"kaiwa"},a={class:"kaiwa-img-right"},i={class:"kaiwa-text-left"},s={class:"kaiwa-text"};function u(t,e,c,u,l,h){return Object(o["t"])(),Object(o["g"])("div",null,[Object(o["j"])(o["c"],{name:"fade"},{default:Object(o["K"])((function(){return[l.chatShow?(Object(o["t"])(),Object(o["g"])("div",n,[Object(o["j"])("figure",a,[Object(o["j"])("img",{src:l.avatar,alt:"no-img2"},null,8,["src"])]),Object(o["j"])("div",i,[Object(o["j"])("p",s,Object(o["F"])(l.chat||"..."),1)])])):Object(o["h"])("",!0)]})),_:1})])}c("99af");var l=c("8055"),h=c.n(l),r={name:"chat",components:{},data:function(){return{chat:"",chatShow:!1,chatShowTimer:null,socket:null,isSpeech:!1,avatar:"https://i.loli.net/2021/08/01/SFHndyel1UJx6wL.png",cloudSel:"googleNiang",appkey:"",AccessToken:"",voice:"xiaoyun"}},computed:{},watch:{},methods:{playVoice:function(t){if(this.isSpeech){var e="";switch(this.cloudSel){case"aliyun":e="https://nls-gateway.cn-shanghai.aliyuncs.com/stream/v1/tts?appkey=".concat(this.appkey,"&token=").concat(this.AccessToken,"&text=").concat(encodeURI(this.chat),"&format=mp3&sample_rate=16000&voice=").concat(this.voice);break;case"googleNiang":e=t;break;case"googleCloud":e=t;break;case"azure":e=t;break;default:break}if(e){var c=new Audio(e);c.load(),c.play()}}},toSocket:function(){var t=this;this.socket=h.a.connect("/socketchat"),this.socket.on("msg",(function(e){console.log(e),t.chat=e.message,t.$nextTick((function(){t.chatShow=!0,t.playVoice(e.voiceUrl)})),clearTimeout(t.chatShowTimer),t.chatShowTimer=setTimeout((function(){t.chatShow=!1}),1e3*t.chat.length)})),this.socket.on("getSettingData",(function(e){console.log(e),t.isSpeech=!!e.isSpeech,t.avatar=e.avatar||"https://i.loli.net/2021/08/01/SFHndyel1UJx6wL.png",t.cloudSel=e.cloudSel||"googleNiang",t.appkey=e.appkey||"",t.AccessToken=e.AccessToken||"",t.voice=e.voice||"xiaoyun"})),this.socket.on("connect",(function(){console.log("已连接")})),this.socket.on("disconnect",(function(){console.log("已断开")}))}},created:function(){this.toSocket()},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeUnmount:function(){this.socket.close()},unmounted:function(){},activated:function(){}};c("670c");r.render=u;e["default"]=r},"670c":function(t,e,c){"use strict";c("fc64")},fc64:function(t,e,c){}}]);
//# sourceMappingURL=chat.d17ad9dc.js.map